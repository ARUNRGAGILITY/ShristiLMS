<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Learning System</title>
    
    <!-- External Dependencies -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-yaml.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-sql.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    
    <!-- Local CSS -->
    <link rel="stylesheet" href="web/css/lms_md.css">
</head>
<body>
    <!-- Top Navigation -->
    <nav class="top-nav">
        <div class="logo">
            <span id="courseIcon">üìö</span>
            <span id="courseTitle">Interactive Learning System</span>
        </div>
        <div class="current-topic" id="currentTopic">Select a Course</div>
        <div class="nav-controls">
            <div class="progress-container">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            <button class="home-btn" onclick="scrollToTop()">üè† Home</button>
        </div>
    </nav>

    <!-- Course Selection -->
    <div class="course-selector" id="courseSelector">
        <div class="course-selection-container">
            <h1>Choose Your Learning Path</h1>
            <div class="course-grid">
                <!-- Course cards will be generated dynamically from config.js -->
            </div>
        </div>
    </div>

    <!-- Main Layout for Course Content -->
    <div class="layout" style="display: none;">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h3>üìñ Table of Contents</h3>
                <button class="back-btn" onclick="goBackToCourseSelection()">‚Üê Back to Courses</button>
            </div>
            <div id="toc-container">
                <!-- Table of contents will be generated by markdown renderer -->
            </div>
        </div>

        <!-- Main Content -->
        <div id="markdown-content" data-auto-init="false">
            <!-- Markdown content will be rendered here -->
        </div>
    </div>

    <!-- Loading Indicator -->
    <div class="loading-indicator" id="loadingIndicator">
        <div class="spinner"></div>
        <p>Loading course content...</p>
    </div>

    <!-- Scripts in correct order -->
    <script>
        // Debug: Check if scripts are loading
        console.log('üìÑ HTML loaded, starting script loading...');
        
        // Global initialization function
        window.initializeSystem = function() {
            console.log('üîç Checking dependencies for initialization...');
            console.log('COURSE_CONFIG available:', typeof COURSE_CONFIG !== 'undefined');
            console.log('MarkdownLearningSystem available:', typeof MarkdownLearningSystem !== 'undefined');
            
            if (typeof COURSE_CONFIG === 'undefined') {
                console.error('‚ùå COURSE_CONFIG not found - check config.js');
                return false;
            }
            if (typeof MarkdownLearningSystem === 'undefined') {
                console.error('‚ùå MarkdownLearningSystem not found - check lms_md.js');
                return false;
            }
            
            console.log('‚úÖ All dependencies loaded, initializing system...');
            if (!window.markdownLearningSystem) {
                window.markdownLearningSystem = new MarkdownLearningSystem();
                console.log('‚úÖ MarkdownLearningSystem initialized successfully');
            }
            return true;
        };
    </script>
    
    <!-- Config file first -->
    <script src="config/config.js"></script>
    
    <!-- Main LMS system (includes MarkdownRenderer) -->
    <script src="web/js/lms_md.js" onload="console.log('‚úÖ lms_md.js loaded'); window.initializeSystem();"></script>
</body>
</html>